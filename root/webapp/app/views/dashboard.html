<div class="hider" ng-show="status.open"></div>

<div ng-show="loading" class="container"><br/><br/>
    <div ng-show="loading" class="loading"><img src="images/loading.gif" alt="Loading"/></div></div>
    <div class="" ng-show="!loading" ng-cloak>
    <h1>Dashboard: {{loggedInUser.username}}</h1>
    <div class="row">
        <div class="col-md-8">
            <div class="tab-panel-item">
                <div class="content-panel">
                    <ul class="pull-right aside-actions unstyled">
                        <li><a href="#" class="aside-link active">Messages<span class="message-count">{{unreadConversationCount}}</span></a></li>
                        <li><a href="#" class="aside-link reply">Join Requests</a></li>
                    </ul>
                    <div class="item-detail row">
                        <dl class="col-md-4">
                            <dt>{{loggedInUser.forename}} {{loggedInUser.surname}}</dt>
                            <dd>Joined {{loggedInUser.created | date:'dd-MMM-yyyy HH:mm'}}</dd>
                        </dl>
                        <dl class="col-md-4">
                            <dt>Last Login</dt>
                            <dd>{{loggedInUser.lastLogin | date:'dd-MMM-yyyy HH:mm'}}
                                <span class="sub-text">from {{loggedInUser.lastLoginIpAddress}}</span>
                            </dd>
                        </dl>
                        <dl class="col-md-8">
                            <dt>Groups (role)</dt>
                            <dd>
                                <ul class="unstyled inline groups-list">
                                    <li ng-repeat="groupRole in loggedInUser.groupRoles | orderBy:[orderGroupRoles,'group.name']">
                                        <span ng-if="groupRole.role.name !== 'MEMBER'">
                                            {{groupRole.group.name}}
                                            <span class="light-text">({{groupRole.role.description}})</span>
                                        </span>
                                    </li>
                                </ul>
                            </dd>
                        </dl>
                    </div>
                </div>
            </div>
        </div>

        <aside class="col-md-4">
            <div class="user-details content-panel">
                <a href="/#/settings" class="btn blue pull-right">Edit</a>
                <h3>Your Settings </h3>
                <ul class="unstyled">
                    <li><h4>Username: {{loggedInUser.username}}</h4></li>
                    <li ng-show="loggedInUser.email">Email: {{loggedInUser.email}}</li>
                    <li ng-show="loggedInUser.contactNumber">Phone: {{loggedInUser.contactNumber}}</li>
                </ul>
            </div>
        </aside>
        <div class="col-md-8">
            <div class="content-panel" ng-show="!chartLoading">
                <select class="form-control" ng-model="graphGroupId"
                        ng-options="group.id as group.name + ' &nbsp;(' + group.groupType.description + ')' for group in graphGroups | orderBy:[orderGroups,'name']"
                        ng-show="graphGroups.length > 2" ng-cloak></select>
                <h2 ng-hide="graphGroups.length > 2" ng-cloak>{{graphGroups[0].name}} ({{graphGroups[0].groupType.description}})</h2>
                <div google-chart chart="chart" style="{{chart.cssStyle}}"></div>
            </div>
            <div class="content-panel" ng-show="chartLoading">
                <div class="loading"><img src="images/loading.gif" alt="Loading"/></div>
            </div>
        </div>

        <aside class="news-container col-md-4">
            <ul class="unstyled">
                <li class="news-item content-panel" ng-repeat="news in newsItems">
                    <div class="content-inner">
                        <ul class="unstyled pull-right">
                            <li ng-repeat="newsLink in news.newsLinks" class="news-link-labels">
                                <span class="label label-primary" ng-show="newsLink.group != null">{{newsLink.group.name}} <span>({{newsLink.role.description}})</span></span>
                                <span class="label label-success" ng-show="newsLink.role != null && newsLink.group == null && newsLink.role.name != 'GLOBAL_ADMIN'">{{newsLink.role.description}}</span>
                            </li>
                        </ul>
                        <p><strong>{{news.heading}}</strong></p>
                        <p>{{news.story}}</p>
                    </div>
                </li>
            </ul>
        </aside>
    </div>
</div>
<br/>