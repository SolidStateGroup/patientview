<h1 data-ng-show="!loading">Join Request Admin</h1>
<div class="content-panel filter-panel" data-ng-show="!loading" data-ng-cloak>
    <div class="">
        <p class="intro-block">Filter join requests by selecting a status from the options below.</p>
    </div>
    <div class="panel-footer clearfix">
        <div class="content-inner">
            <div class="pull-right" data-ng-show="pagedItems.length > 0">
                <h5>Page {{currentPage+1}} of {{totalPages}} ({{total}} total)</h5>
            </div>
            <div class="form-horizontal" role="form">
                <!-- filter by code type -->
                <div class="select-container pull-left">
                    <div class="btn-group filter-select" id="filter-standard-type" data-ng-class="{open: open1}">
                        <button class="btn dropdown-toggle" data-ng-click="open1=!open1">Filter By Status <span class="caret-container"><span class="caret"></span></span></button>
                        <ul class="dropdown-menu" aria-labelledby="dropdownMenu">
                            <li><a data-ng-click="removeAllStatuses()"><i class="glyphicon glyphicon-remove"></i> Uncheck All</a></li>
                            <li class="divider"></li>
                            <li data-ng-repeat="status in statuses">
                                <a data-ng-click="setSelectedStatus()">
                                    <span class="pull-left">{{status}}</span>
                                    <span data-ng-class="isStatusChecked(status)"></span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <span data-ng-repeat="status in statuses" data-ng-show="isStatusChecked(status)"><span class="label label-info">{{status}}</span>&nbsp;</span>
                </div>
                <!-- filter by group -->
                <div class="select-container pull-left">
                    <div class="btn-group filter-select" id="filter-group" data-ng-class="{open: open2}">
                        <button class="btn dropdown-toggle" data-ng-click="open2=!open2">Filter By Group <span class="caret-container"><span class="caret"></span></span></button>
                        <ul class="dropdown-menu" aria-labelledby="dropdownMenu">
                            <li><a data-ng-click="removeAllSelectedGroup()" class="a-filter-group"><i class="glyphicon glyphicon-remove"></i> Uncheck All</a></li>
                            <li class="divider"></li>
                            <li data-ng-repeat="group in allGroups"> <a data-ng-click="setSelectedGroup()" class="a-filter-group clearfix"><span class="pull-left">{{group.name}}</span><span data-ng-class="isGroupChecked(group.id)"></span></a></li>
                        </ul>
                    </div>
                    <span data-ng-repeat="group in allGroups" data-ng-show="isGroupChecked(group.id)"><span class="label label-info">{{group.name}}</span>&nbsp;</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- data grid -->
<div class="faux-table eight-col" data-ng-show="pagedItems.length > 0 && !loading" data-ng-cloak>

    <div class="table-head accordion-title-row">
        <div class="hidden">ID</div>
        <div class="head-item accordion-title-text ">
            <a data-ng-click="sortBy('forename');" class="sort-title"><i class="icon-sort pull-right"></i>Name</a>
        </div>
        <div class="head-item accordion-title-text ">Date of Birth</div>
        <div class="head-item accordion-title-text ">NHS Number</div>
        <div class="head-item accordion-title-text ">Email</div>
        <div class="head-item accordion-title-text ">Unit</div>
        <div class="head-item accordion-title-text ">
            <a data-ng-click="sortBy('created');" class="sort-title"><i class="icon-sort pull-right"></i>Date of Request</a>
        </div>
        <div class="head-item accordion-title-text ">Status</div>
        <div class="head-item accordion-title-text "></div>
    </div>

    <div class="item-header" data-ng-repeat="joinRequest in pagedItems">
        <div class="faux-row">
            <div class="row-item hidden">{{joinRequest.id}}</div>
            <div class="row-item accordion-heading-text">{{joinRequest.forename}} {{joinRequest.surname}}</div>
            <div class="row-item accordion-heading-text">{{joinRequest.dateOfBirth  | date:'dd-MMM-yyyy'}}</div>
            <div class="row-item accordion-heading-text">{{joinRequest.nhsNumber}}</div>
            <div class="row-item accordion-heading-text">{{joinRequest.email}}</div>
            <div class="row-item accordion-heading-text">{{joinRequest.group.name}}</div>
            <div class="row-item accordion-heading-text">{{joinRequest.created  | date:'dd-MMM-yyyy'}}</div>
            <div class="row-item accordion-heading-text">
                <span data-ng-if="joinRequest.status==='COMPLETED'" class="badge badge-small completed"></span>
                <span data-ng-if="joinRequest.status==='SUBMITTED'" class="badge badge-small warning"></span>
                <span data-ng-if="joinRequest.status==='INCOMPLETE'" class="badge badge-small warning"></span>
                <span data-ng-if="joinRequest.status==='IGNORED'" class="badge badge-small ignored"></span>
                <span data-ng-if="joinRequest.status==='DUPLICATE'" class="badge badge-small ignored"></span>
                {{joinRequest.status}}
            </div>
            <div class="row-item accordion-heading-text">
                <button type="button" class="btn blue" data-ng-click="opened(joinRequest)">Edit</button>
            </div>
        </div>
        <div class="panel-body" data-ng-show="joinRequest.showEdit">
            <div data-ng-show="joinRequest.editLoading" class="loading"><img src="images/loading.gif" alt="Loading"/></div>
            <div data-ng-show="!joinRequest.editLoading">
                <form name="joinRequestForm">
                    <div data-ng-include src="'views/partials/joinrequestdetails.html'"></div>
                </form>
            </div>
        </div>
    </div>
</div>

<div data-ng-show="pagedItems.length == 0 && !loading">
    <br/>
    <h4>No Join Requests found</h4>
</div>

<!-- pagination -->
<div ng-include src="'views/partials/pagination.html'"></div>

<div data-ng-show="loading" class="container"><br/><br/>
    <div data-ng-show="loading" class="loading">
        <h3><img src="images/loading.gif" alt="Loading"/>&nbsp; Loading Join Requests</h3>
    </div>
</div>